---
layout: default
title: Dependencies
---
<body>

<h1>Dependencies</h1>

<ol>

<li><strong>Conda:</strong> FilTar is a snakemake project and it is therefore required that the conda package manager is installed on your system. The easiest way to do this is to obtain conda through the relatively lightweight miniconda python distribution, which only contains conda and its dependencies (<a href="https://conda.io/docs/user-guide/install/index.html">Installation Instructions</a>).</li></br>

<li><strong>Snakemake:</strong> <a href="https://snakemake.readthedocs.io/en/stable/getting_started/installation.html">Snakemake</a> can be installed using conda easily with the following command:

<p><code>conda install -c bioconda -c conda-forge snakemake</code></p>
</li><br>

<li><strong>filtar (R package):</strong> The filtar R package also exists to perform a series of data manipulations within the main FilTar workflow. It can be installed via use of the devtools R package with the following command within the R console:

<p><code>devtools::install_github('TBradley27/filtar')</code></p>

<p>If devtools is not already installed on your system, then it can be installed via CRAN (The Comprehensive R Archive Network).</p>

</li><br>

<li><strong>Perl modules:</strong> It is not recommended to install perls module using conda*. The recommended method of installing perl modules for us with filtar is to install cpanm perl package manager, and then to manually install perl modules using cpanm. cpanm can itself be installed using conda:

<p><code>conda install -c bioconda perl-app-cpanminus</code><br></p>

Two perl modules are needed to correctly execute targetscan7 - <code>Bio::TreeIO</code> and <code>Statistics::Lite</code>. <p>They can be installed as follows:</p>

<p><code>cpanm Bio::Perl</code><br></p>
<p><code>cpanm Statistics::Lite</code></p>

APAtrap needs the following modules to be installed in order to run: <code>Getopt::Long</code>,<code>Smart::Comments</code>,<code>List::Util</code>,<code>experimental</code>,<code>List::MoreUtils</code> and <code>Math::NumberCruncher</code><br>

* This is because conda installs perl modules in different non-interacting directories using different installations of perl, making them very difficult if not possible to use together.
</li><br>
<li><strong>Other:</strong> For the remaining dependencies, the user has the choice of the following two options:<br><br>

	<ol>
	<li>  To allow dependencies to be managed within the snakemake workflow. If the <code>--use-conda</code> flag (see later) is used when executing snakemake, then snakemake will use conda to download and/or activate environments containing dependencies needed to execute a given rule (i.e. job within the larger workflow). That environment will then be reactivated whenever that same rule is executed.<br><br>

For example, if the <code>--use-conda</code> flag is used, filtar will download and install HISAT2 and run it within its own self-contained conda environment. The dependency would be installed within conda, so root priviliges would not be needed.</li><br>

	<li>The user can manage their own dependencies outside of the filtar workflow. If the <code>--use-conda</code> flag is not used, then filtar will try and find HISAT2 within the current environment using the PATH environment variable.</li>	
	</ol>

<p>Note 1: Option 1) may cause problems on systems such as some HPC environments in which data download and resource-expensive jobs cannot occur on the same node/machine. In which case option 2) may be preferable. However, for more recent versions of snakemake, all data downloads occur before subsequent job execution, in which case, it may br advisable to download data on one machine, then re-execute the workflow on a different machine to complete jobs.</p>

Note 2: For more flexibility if users would like filtar to manage some dependencies internally (e.g. HISAT2) and some dependencies externally (e.g. trim galore) they could edit the relevant Snakefile and comment out the 'conda' directive from the relevant rule.
In this case, that rule's dependencies would not be managed internally by filtar even when the <code>--use-conda</code> flag is used when executing the 'snakemake' command
</li>
</ol>
</body>		
