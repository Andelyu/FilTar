#!/bin/bash

def get_bed6_file(wildcards):
        if wildcards.species == 'hsa':
                return('results/Homo_sapiens.GRCh38.94.bed6')
        elif wildcards.species == 'mmu':
                return('results/Mus_musculus.GRCm38.94.bed6')

rule get_bed6_file: #three_prime_utrs only
        input:
            script="exe/gtf_to_bed.sh",
            gtf="data/{prefix}.gtf"
        output:
            "results/{prefix}.bed6"
        shell:
            "{input.script} {input.gtf} {output}"

rule get_extended_bed_file:
         input:
            normal_bed= get_bed6_file,
            extended_bed="results/bed/{species}_{tissue}.utr.bed",
            all_transcripts="results/bed/{species}_all_transcripts.txt"
         output:
            "results/bed/{species}_{tissue}.utr.full.bed"
         log:
            "{species}_{tissue}.log"
         script:
             "extend_bed2.R"
